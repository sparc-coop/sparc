@page "/blog/{slug}"

<article class="blog-post">
    <header>
        <h1 class="@(IsPlaceholder("title") ? "placeholder" : "")">
            @GetTag("title")
        </h1>

        <aside class="@(IsPlaceholder("author") ? "placeholder" : "")">
            @GetTag("author")
        </aside>

        <time datetime="@(DateTime.Now.ToString("O"))">
            @DateTime.Now.ToString("MMMM d, yyyy")
        </time>
    </header>

    <figure>
        <img src="@GetTag("imageUrl")" alt="@GetTag("title")" class="@(IsPlaceholder("imageUrl") ? "placeholder" : "")" />
    </figure>

    <section class="content">
        <p class="@(IsPlaceholder("content") ? "placeholder" : "")">
            @GetTag("content")
        </p>
    </section>
</article>

@code {
    [Parameter] public string? Slug { get; set; }

    private Kori.TagManager B { get; } = new Kori.TagManager();

    private Dictionary<string, string> DefaultValues;

    protected override void OnInitialized()
    {
        DefaultValues = new Dictionary<string, string>
        {
            { "title", "Type your Title here" },
            { "author", "Type your Name here" },
            { "imageUrl", $"data:image/svg+xml;base64,{ConvertToBase64Image()}" },
            { "content", "Type the blog post content here." }
        };

        foreach (var key in DefaultValues.Keys)
        {

            B[key] = DefaultValues[key];
        }
    }

    private string GetTag(string key)
    {
        return B[key];
    }

    private bool IsPlaceholder(string key)
    {
        return B[key] == DefaultValues[key];
    }

    private static string ConvertToBase64Image()
    {
        string svg = @"
            <svg xmlns='http://www.w3.org/2000/svg' width='600' height='400'>
                <rect width='100%' height='100%' fill='#f2f2f2' />
                <text x='50%' y='50%' alignment-baseline='middle' text-anchor='middle' fill='#888' font-family='Arial, sans-serif' font-size='24'>
                    Upload your image here
                </text>
            </svg>";

        return Convert.ToBase64String(System.Text.Encoding.UTF8.GetBytes(svg));
    }
}